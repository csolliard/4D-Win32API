/*
	File:		Components.h

	Copyright:	© 1984-1993 by Apple Computer, Inc., all rights reserved.

	WARNING
	This file was auto generated by the interfacer tool. Modifications
	must be made to the master file.

*/

#ifndef __COMPONENTS__
#define __COMPONENTS__

#ifndef __TYPES__
#include <MacTypes.H>
#endif

#define kAppleManufacturer OST_appl

#define kComponentResourceType OST_thng

enum  {
	kAnyComponentType			= 0,
	kAnyComponentSubType		= 0,
	kAnyComponentManufacturer	= 0,
	kAnyComponentFlagsMask		= 0
};

#define	cmpWantsRegisterMessage	(1L << 31)

enum  {
	kComponentOpenSelect		= -1,			/* ComponentInstance for this open */
	kComponentCloseSelect		= -2,			/* ComponentInstance for this close */
	kComponentCanDoSelect		= -3,			/* selector # being queried */
	kComponentVersionSelect		= -4,			/* no params */
	kComponentRegisterSelect	= -5,			/* no params */
	kComponentTargetSelect		= -6,			/* ComponentInstance for top of call chain */
	kComponentUnregisterSelect	= -7			/* no params */
};


/* Component Resource Extension flags */

enum  {
	componentDoAutoVersion		= (1 << 0),
	componentWantsUnregister	= (1 << 1),
	componentAutoVersionIncludeFlags = (1 << 2),
	componentHasMultiplePlatforms = (1 << 3)
};


/* Set Default Component flags */

enum  {
	defaultComponentIdentical	= 0,
	defaultComponentAnyFlags	= 1,
	defaultComponentAnyManufacturer = 2,
	defaultComponentAnySubType	= 4,
	defaultComponentAnyFlagsAnyManufacturer = (defaultComponentAnyFlags + defaultComponentAnyManufacturer),
	defaultComponentAnyFlagsAnyManufacturerAnySubType = (defaultComponentAnyFlags + defaultComponentAnyManufacturer + defaultComponentAnySubType)
};

struct ComponentDescription {
	OSType			componentType;			/* A unique 4-byte code indentifying the command set */
	OSType			componentSubType;			/* Particular flavor of this instance */
	OSType			componentManufacturer;			/* Vendor indentification */
	unsigned long			componentFlags;			/* 8 each for Component,Type,SubType,Manuf/revision */
	unsigned long			componentFlagsMask;			/* Mask for specifying which flags to consider in search, zero during registration */
};
typedef struct ComponentDescription ComponentDescription;

struct ResourceSpec {
	OSType			resType;			/* 4-byte code  */
	short			resId;
};
typedef struct ResourceSpec ResourceSpec;

struct ComponentResource {
	ComponentDescription		cd;			/* Registration parameters */
	ResourceSpec			component;			/* resource where Component code is found */
	ResourceSpec			componentName;			/* name string resource */
	ResourceSpec			componentInfo;			/* info string resource */
	ResourceSpec			componentIcon;			/* icon resource */
};
typedef struct ComponentResource ComponentResource;

typedef ComponentResource *ComponentResourcePtr, **ComponentResourceHandle;

struct ComponentPlatformInfo {
	long			componentFlags;			/* flags of Component */
	ResourceSpec			component;			/* resource where Component code is found */
	short			platformType;			/* gestaltSysArchitecture result */
};
typedef struct ComponentPlatformInfo ComponentPlatformInfo;

struct ComponentResourceExtension {
	long			componentVersion;			/* version of Component */
	long			componentRegisterFlags;			/* flags for registration */
	short			componentIconFamily;			/* resource id of Icon Family */
};
typedef struct ComponentResourceExtension ComponentResourceExtension;

struct ComponentPlatformInfoArray {
	long			count;
	ComponentPlatformInfo		platformArray[1];
};
typedef struct ComponentPlatformInfoArray ComponentPlatformInfoArray;

struct ExtComponentResource {
	ComponentDescription		cd;			/* registration parameters */
	ResourceSpec			component;			/* resource where Component code is found */
	ResourceSpec			componentName;			/* name string resource */
	ResourceSpec			componentInfo;			/* info string resource */
	ResourceSpec			componentIcon;			/* icon resource */
	long			componentVersion;			/* version of Component */
	long			componentRegisterFlags;			/* flags for registration */
	short			componentIconFamily;			/* resource id of Icon Family */
	long			count;			/* elements in platformArray */
	ComponentPlatformInfo		platformArray[1];
};
typedef struct ExtComponentResource ExtComponentResource;

struct ComponentParameters {
	unsigned char			flags;			/* call modifiers: sync/async, deferred, immed, etc */
	unsigned char			paramSize;			/* size in bytes of actual parameters passed to this call */
	short			what;			/* routine selector, negative for Component management calls */
	long			params[1];			/* actual parameters for the indicated routine */
};
typedef struct ComponentParameters ComponentParameters;

struct ComponentRecord {
	long			data[1];
};
typedef struct ComponentRecord ComponentRecord;

typedef ComponentRecord *Component;

struct ComponentInstanceRecord {
	long			data[1];
};
typedef struct ComponentInstanceRecord ComponentInstanceRecord;

typedef ComponentInstanceRecord *ComponentInstance;

typedef long ComponentResult;

typedef ComponentResult (pascal *ComponentRoutineProcPtr)(ComponentParameters *cp, Handle componentStorage);

enum {
	uppComponentRoutineProcInfo = kPascalStackBased
		| RESULT_SIZE(SIZE_CODE(sizeof(ComponentResult)))
		| STACK_ROUTINE_PARAMETER(1, SIZE_CODE(sizeof(ComponentParameters*)))
		| STACK_ROUTINE_PARAMETER(2, SIZE_CODE(sizeof(Handle)))
};

#if USESROUTINEDESCRIPTORS
typedef UniversalProcPtr ComponentRoutineUPP;

#define CallComponentRoutineProc(userRoutine, cp, componentStorage)		\
		CallUniversalProc((UniversalProcPtr)(userRoutine), uppComponentRoutineProcInfo, (cp), (componentStorage))
#define NewComponentRoutineProc(userRoutine)		\
		(ComponentRoutineUPP) NewRoutineDescriptor((ProcPtr)(userRoutine), uppComponentRoutineProcInfo, GetCurrentISA())
#else
typedef ComponentRoutineProcPtr ComponentRoutineUPP;

#define CallComponentRoutineProc(userRoutine, cp, componentStorage)		\
		(*(userRoutine))((cp), (componentStorage))
#define NewComponentRoutineProc(userRoutine)		\
		(ComponentRoutineUPP)(userRoutine)
#endif

typedef ComponentRoutineProcPtr ComponentRoutine;


/*
	The parameter list for each ComponentFunction is unique. It is
	therefore up to users to create the appropriate procInfo for their
	own ComponentFunctions where necessary.
*/

typedef UniversalProcPtr ComponentFunctionUPP;

#if USES68KINLINES
#define ComponentCallNow(callNumber, paramSize)  \
	= {0x2F3C,paramSize,callNumber,0x7000,0xA82A}

#else
#define ComponentCallNow(callNumber, paramSize)

extern UniversalProcPtr CallComponentUPP;

#endif

#ifdef __cplusplus
extern "C" {
#endif


/********************************************************
 * Component Database Add, Delete, and Query Routines
 ********************************************************/

extern Component pascal RegisterComponent(ComponentDescription *cd, ComponentRoutineUPP componentEntryPoint, short global, Handle componentName, Handle componentInfo, Handle componentIcon);
extern Component pascal RegisterComponentResource(ComponentResourceHandle tr, short global);
extern OSErr pascal UnregisterComponent(Component aComponent);
extern Component pascal FindNextComponent(Component aComponent, ComponentDescription *looking);
extern long pascal CountComponents(ComponentDescription *looking);
extern OSErr pascal GetComponentInfo(Component aComponent, ComponentDescription *cd, Handle componentName, Handle componentInfo, Handle componentIcon);
extern long pascal GetComponentListModSeed(void);

/********************************************************
 * Component Instance Allocation and dispatch routines
 ********************************************************/

extern ComponentInstance pascal OpenComponent(Component aComponent);
extern OSErr pascal CloseComponent(ComponentInstance aComponentInstance);
extern OSErr pascal GetComponentInstanceError(ComponentInstance aComponentInstance);

/* Direct calls to the Components */

extern long pascal ComponentFunctionImplemented(ComponentInstance ci, short ftnNumber);
extern long pascal GetComponentVersion(ComponentInstance ci);
extern long pascal ComponentSetTarget(ComponentInstance ci, ComponentInstance target);
#ifdef __cplusplus
}
#endif

#ifdef __cplusplus
extern "C" {
#endif


/********************************************************
 * Component Management routines
 ********************************************************/

extern void pascal SetComponentInstanceError(ComponentInstance aComponentInstance, OSErr theError);
extern long pascal GetComponentRefcon(Component aComponent);
extern void pascal SetComponentRefcon(Component aComponent, long theRefcon);
extern short pascal OpenComponentResFile(Component aComponent);
extern OSErr pascal CloseComponentResFile(short refnum);

/********************************************************
 * Component Instance Management routines
 ********************************************************/

extern Handle pascal GetComponentInstanceStorage(ComponentInstance aComponentInstance);
extern void pascal SetComponentInstanceStorage(ComponentInstance aComponentInstance, Handle theStorage);
extern long pascal GetComponentInstanceA5(ComponentInstance aComponentInstance);
extern void pascal SetComponentInstanceA5(ComponentInstance aComponentInstance, long theA5);
extern long pascal CountComponentInstances(Component aComponent);

/* Useful helper routines for convenient method dispatching */

extern long pascal CallComponentFunction(ComponentParameters *params, ComponentFunctionUPP func);
extern long pascal CallComponentFunctionWithStorage(Handle storage, ComponentParameters *params, ComponentFunctionUPP func);
extern long pascal DelegateComponentCall(ComponentParameters *originalParams, ComponentInstance ci);
#ifdef __cplusplus
}
#endif

#ifdef __cplusplus
extern "C" {
#endif

extern OSErr pascal SetDefaultComponent(Component aComponent, short flags);
extern ComponentInstance pascal OpenDefaultComponent(OSType componentType, OSType componentSubType);
extern Component pascal CaptureComponent(Component capturedComponent, Component capturingComponent);
extern OSErr pascal UncaptureComponent(Component aComponent);
extern long pascal RegisterComponentResourceFile(short resRefNum, short global);
extern OSErr pascal GetComponentIconSuite(Component aComponent, Handle *iconSuite);
#ifdef __cplusplus
}
#endif

#endif


